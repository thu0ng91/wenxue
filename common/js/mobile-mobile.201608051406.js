/*!
 * NEWSOUL's production http://newsoul.cn
 * Copyright 2016
 * Author zmf http://blog.newsoul.cn
 * This is NOT a freeware, use is subject to license terms
 */
function rebind(){$("img.lazy").lazyload({threshold:600}),$("a[action=getContents]").unbind("click").click(function(){var a=$(this),b=a.attr("data-id"),c=a.attr("data-type"),d=a.attr("data-page"),e=a.attr("data-target");if(!e)return!1;if("1"===a.attr("data-loaded"))return $("#"+e+"-box").hide(),a.attr("data-loaded",0),!1;d||(d=1);var f='<div class="loading-holder"><a class="btn btn-default btn-sm disabled" href="javascript:;">拼命加载中...</a></div>';$("#"+e).children(".loading-holder").each(function(){$(this).remove()}),$("#"+e).append(f),$("#"+e+"-box").show(),$.post(zmf.ajaxUrl,{action:"getContents",type:c,page:d,data:b,YII_CSRF_TOKEN:zmf.csrfToken},function(f){if(ajaxReturn=!0,a.attr("data-loaded",1),f=$.parseJSON(f),1===f.status){var g=f.msg,h="",i="";if(""!==g.html&&(i+=g.html),1===g.loadMore){var j=parseInt(d)+1;h+='<div class="loading-holder"><a class="btn btn-default btn-sm"  href="javascript:;" action="getContents" data-type="'+c+'" data-id="'+b+'" data-page="'+j+'" data-target="'+e+'">加载更多</a></div>'}else h+=""===g.html&&1===d?"":'<div class="loading-holder"><a class="btn btn-default btn-sm disabled" href="javascript:;">已全部加载</a></div>';$("#"+e+" .loading-holder").each(function(){$(this).remove()}),d>1?$("#"+e).append(i):(""===g.html&&(i='<div class="help-block text-center">暂无内容</div>'),$("#"+e).html(i)),$("#"+e).append(h),1===d&&$("#"+e+"-form").html(g.formHtml),rebind()}else dialog({msg:f.msg})})}),$("a[action=delContent]").unbind("click").click(function(){var a=$(this),b=a.attr("data-id"),c=a.attr("data-type"),d=a.attr("data-confirm"),e=a.attr("data-redirect"),f=a.attr("data-target");if(!b||!c)return!1;var g=!0;return 1===parseInt(d)&&(g=confirm("确定删除此内容？")?!0:!1),g&&checkAjax()?void $.post(zmf.ajaxUrl,{action:"delContent",type:c,data:b,YII_CSRF_TOKEN:zmf.csrfToken},function(a){return ajaxReturn=!0,a=$.parseJSON(a),1===a.status?e?window.location.href=e:f?$("#"+f).fadeOut(500).remove():alert(a.msg):dialog({msg:a.msg}),!1}):!1}),$("a[action=delBook]").unbind("click").click(function(){var a=$(this).attr("data-id"),b=$(this).attr("data-redirect");if(!a)return dialog({msg:"请选择小说"}),!1;var c='<div class="form-group"><label for="author-passwd">请输入密码</label><input type="password" id="author-passwd" class="form-control" placeholder="请输入登录作者中心的密码"/><p class="help-block">该操作不可逆，请谨慎考虑</p></div>';dialog({msg:c,title:"确定删除小说？",action:"confirmDelBook"}),$("button[action=confirmDelBook]").unbind("click").click(function(){var c=$("#author-passwd").val();return c?void $.post(zmf.ajaxUrl,{action:"delBook",bid:a,passwd:c,YII_CSRF_TOKEN:zmf.csrfToken},function(a){return a=$.parseJSON(a),1===a.status?(alert(a.msg),window.location.href=b,!1):(alert(a.msg),!1)}):(alert("请输入密码"),!1)})}),$("a[action=delChapter]").unbind("click").click(function(){var a=$(this).attr("data-id");if(!a)return dialog({msg:"请选择小说章节"}),!1;var b='<div class="form-group"><label for="author-passwd">请输入密码</label><input type="password" id="author-passwd" class="form-control" placeholder="请输入登录作者中心的密码"/><p class="help-block">该操作不可逆，请谨慎考虑</p></div>';dialog({msg:b,title:"确定删除本章节？",action:"confirmDelChapter"}),$("button[action=confirmDelChapter]").unbind("click").click(function(){var b=$("#author-passwd").val();return b?void $.post(zmf.ajaxUrl,{action:"delChapter",cid:a,passwd:b,YII_CSRF_TOKEN:zmf.csrfToken},function(a){return a=$.parseJSON(a),1===a.status?(alert(a.msg),window.location.reload(),!1):(alert(a.msg),!1)}):(alert("请输入密码"),!1)})}),$("a[action=finishBook]").unbind("click").click(function(){var a=$(this).attr("data-id");if(!a)return dialog({msg:"请选择小说"}),!1;var b='<div class="form-group"><label for="author-passwd">请输入密码</label><input type="password" id="author-passwd" class="form-control" placeholder="请输入登录作者中心的密码"/><p class="help-block">完结小说后将不能再续写章节</p></div>';dialog({msg:b,title:"确定完结本小说？",action:"confirmFinishBook"}),$("button[action=confirmFinishBook]").unbind("click").click(function(){var b=$("#author-passwd").val();return b?void $.post(zmf.ajaxUrl,{action:"finishBook",bid:a,passwd:b,YII_CSRF_TOKEN:zmf.csrfToken},function(a){return a=$.parseJSON(a),1===a.status?(alert(a.msg),window.location.reload(),!1):(alert(a.msg),!1)}):(alert("请输入密码"),!1)})}),$("a[action=favorite]").unbind("click").click(function(){var a=$(this);favorite(a)}),$(".tag-item").unbind("click").click(function(){var a=$(this);a.hasClass("active")?(a.removeClass("active"),a.children("input").removeAttr("checked")):(a.addClass("active"),a.children("input").attr("checked","checked"))}),$(".comment-textarea").unbind("click").click(function(){$(".toggle-area").each(function(){$(this).fadeIn(500)})}),$("a[action=add-comment]").unbind("click").click(function(){var a=$(this),b=a.attr("action-data"),c=a.attr("action-type");addComment(a,c,b)}),$("a[action=add-tips]").unbind("click").click(function(){var dom=$(this),k=dom.attr("action-data"),t=dom.attr("action-type"),c=$("#content-"+t+"-"+k).val(),score=parseInt($('#add-tips-score input[name="score"]:checked ').val());return k&&t&&c?c.length<20?(dialog({msg:"点评内容不小于20字"}),!1):(score||(score=0),(!score||1>score||score>5)&&0===to?(dialog({msg:"请打一个分吧"}),!1):checkAjax()?void $.post(zmf.ajaxUrl,{action:"addTip",k:k,t:t,c:c,score:score,YII_CSRF_TOKEN:zmf.csrfToken},function(result){ajaxReturn=!0,result=eval("("+result+")"),"1"==result.status?($("#content-"+t+"-"+k).val(""),$("#comments-"+t+"-"+k).append(result.msg),cancelReplyOne(k),rebind()):dialog({msg:result.msg})}):!1):(dialog({msg:"请填写内容"}),!1)}),$("a[action=scroll]").unbind("click").click(function(){var a=$(this),b=a.attr("action-target");return b?void $("body,html").animate({scrollTop:$("#"+b).offset().top},200):!1}),$("a[action=share]").unbind("click").click(function(){var a=$(this);share(a)}),$("a[action=setStatus]").unbind("click").click(function(){var dom=$(this),id=parseInt(dom.attr("data-id"));if(!id)return alert("缺少参数"),!1;var type=dom.attr("data-type");if(!type)return alert("缺少参数"),!1;var action=dom.attr("data-action");return action?void(confirm("确定该操作？")&&$.post(zmf.ajaxUrl,{action:"setStatus",type:type,id:id,actype:action,YII_CSRF_TOKEN:zmf.csrfToken},function(result){return result=eval("("+result+")"),"1"!=result.status?(dialog({msg:result.msg}),!1):void window.location.reload()})):(alert("缺少参数"),!1)}),$("a[action=publishBook]").unbind("click").click(function(){var dom=$(this),id=parseInt(dom.attr("data-id")),type=parseInt(dom.attr("data-action"));if(!id)return alert("缺少参数"),!1;type||(type="publish");var msg="";"publish"===type?msg="确定立即发表作品么？":"finish"===type&&(msg="确定标记为已完结么，标记后将不能再续写新章节？"),confirm(msg)&&$.post(zmf.ajaxUrl,{action:"publishBook",id:id,type:type,YII_CSRF_TOKEN:zmf.csrfToken},function(result){return result=eval("("+result+")"),"1"!=result.status?(dialog({msg:result.msg}),!1):void window.location.reload()})}),$("a[action=publishChapter]").unbind("click").click(function(){var dom=$(this),id=parseInt(dom.attr("data-id"));return id?void(confirm("确定立即发表本章节么？")&&$.post(zmf.ajaxUrl,{action:"publishChapter",id:id,YII_CSRF_TOKEN:zmf.csrfToken},function(result){return result=eval("("+result+")"),"1"!=result.status?(dialog({msg:result.msg}),!1):void window.location.reload()})):(alert("缺少参数"),!1)}),$("#add-post-btn").unbind("click").click(function(){$(window).unbind("beforeunload")}),$("a[action=showChapters]").unbind("click").click(function(){var a=$(this);a.hasClass("active")?(a.removeClass("active"),$("#fixed-chapters").hide()):(a.addClass("active"),$("#fixed-chapters").show())}),$("a[action=nextChapter]").unbind("click").click(function(){var a=$("#nextChapter"),b=a.attr("title");b=b?b:a.attr("data-original-title"),b=b?b:"正在加载";var c=a.attr("href");"javascript:;"!==c&&""!==c?window.location.href=c:simpleDialog({content:b})}),$("a[action=preChapter]").unbind("click").click(function(){var a=$("#preChapter"),b=a.attr("title");b=b?b:a.attr("data-original-title"),b=b?b:"正在加载";var c=a.attr("href");"javascript:;"!==c&&""!==c?window.location.href=c:simpleDialog({content:b})}),$(".tooltip").mouseover(function(){$(this).remove()}),$("a[action=feedback]").unbind("click").click(function(){var a='<div class="form-group"><label for="feedback-contact">联系方式</label><input type="text" id="feedback-contact" class="form-control" placeholder="常用联系方式(邮箱、QQ、微信等)，便于告知反馈处理进度(可选)"/></div><div class="form-group"><label for="feedback-content">反馈内容</label><textarea id="feedback-content" class="form-control" max-lenght="255" placeholder="您的意见或建议"></textarea></div>';dialog({msg:a,title:"意见反馈",action:"feedback"}),$("button[action=feedback]").unbind("click").click(function(){feedback()})}),$("a[action=report]").unbind("click").click(function(){var dom=$(this),type=dom.attr("action-type"),id=dom.attr("action-id"),title=dom.attr("action-title");if(!type)return alert("缺少参数"),!1;var html='<div class="form-group"><label>举报对象</label><p class="help-block ui-nowarp">'+title+'</p><input type="hidden" name="report-id" id="report-id" value="'+id+'"/></div>';if("book"===type||"chapter"===type)html+='<div class="form-group"><label for="feedback-reason">举报原因</label><select name="report-reason" id="report-reason" class="form-control"><option value="色情低俗">色情低俗</option><option value="暴力血腥">暴力血腥</option><option value="涉政违规">涉政违规</option><option value="欺诈广告">欺诈广告</option><option value="抄袭侵权">抄袭侵权</option><option value="">其他原因</option></select></div>';else{if("tip"!==type&&"book"!==type&&"comment"!==type&&"post"!==type&&"user"!==type&&"author"!==type)return alert("暂不支持该分类"),!1;html+='<div class="form-group"><label for="feedback-reason">举报原因</label><select name="report-reason" id="report-reason" class="form-control"><option value="恶意攻击">恶意攻击</option><option value="色情低俗">色情低俗</option><option value="暴力血腥">暴力血腥</option><option value="涉政违规">涉政违规</option><option value="欺诈广告">欺诈广告</option><option value="抄袭侵权">抄袭侵权</option><option value="">其他原因</option></select></div>'}html+='<div class="form-group displayNone" id="report-content-holder"><label for="report-content">其他原因</label><textarea id="report-content" class="form-control" max-lenght="255" placeholder="请描述你的举报原因"></textarea></div>',checkLogin()||(html+='<div class="form-group"><label for="report-contact">联系方式</label><input type="text" id="report-contact" class="form-control" placeholder="常用联系方式(邮箱、QQ、微信等)，便于告知处理进度(可选)"/></div>'),dialog({msg:html,title:"举报",action:"doReport"}),$("#report-reason").on("change",function(){var a=$(this).val();a?$("#report-content-holder").hide():$("#report-content-holder").show()}),$("button[action=doReport]").unbind("click").click(function(){var logid=$("#report-id").val(),reason=$("#report-reason").val(),content=$("#report-content").val(),contact=$("#report-contact").val();return logid?reason||content?(reason||(reason=content),contact||(contact=""),void $.post(zmf.ajaxUrl,{action:"report",logid:logid,type:type,reason:reason,contact:contact,url:window.location.href,YII_CSRF_TOKEN:zmf.csrfToken},function(result){return result=eval("("+result+")"),"1"==result.status?(simpleDialog({content:result.msg}),closeDialog(),!1):(simpleDialog({content:result.msg}),!1)})):(simpleDialog({content:"请填写举报原因"}),!1):(alert("缺少参数"),!1)})}),$(".openGallery").unbind("click").click(function(){var dom=$(this),holder=dom.attr("data-holder"),field=dom.attr("data-field");dialog({msg:'<div id="gallery-select-modal" class="gallery-body"></div>',title:"选择图片"}),$.post(zmf.userGalleryUrl,{from:"selectImg",YII_CSRF_TOKEN:zmf.csrfToken},function(result){result=eval("("+result+")"),"1"==result.status?($("#gallery-select-modal").html(result.msg.html),$(".select-gallery-img").unbind("click").click(function(){var a=$(this);selectThisImg(a,holder,field)}),rebind()):alert(result.msg)})}),$(".sendSms-btn").unbind("click").click(function(){var dom=$(this),_target=dom.attr("data-target");if(!_target)return dialog({msg:"请输入手机号"}),!1;var phone=$("#"+_target).val();if(!phone)return dialog({msg:"请输入手机号"}),!1;var type=dom.attr("data-type");return type?void $.post(zmf.ajaxUrl,{action:"sendSms",type:type,phone:phone,YII_CSRF_TOKEN:zmf.csrfToken},function(result){if(result=eval("("+result+")"),1===result.status){var totalTime=60,times=0;dom.text("重新发送 "+totalTime+"s").attr("disabled","disabled");var interval=setInterval(function(){times+=1;var a=totalTime-times;dom.text("重新发送 "+a+"s"),0>=a&&(clearInterval(interval),dom.removeAttr("disabled").text("重新发送"))},1e3);$("#forgot-hidden").show()}else dialog({msg:result.msg})}):(dialog({msg:"缺少类型参数"}),!1)}),$(".nextStep-btn").unbind("click").click(function(){var dom=$(this),hasError=!1;$("#send-sms-form .bitian").each(function(){var a=$(this);return a.val()?void 0:(hasError=!0,dialog({msg:a.attr("placeholder")+"不能为空"}),!1)});var type=dom.attr("data-type");if(!type)return dialog({msg:"缺少类型参数"}),!1;var _target=dom.attr("data-target");if(!_target)return dialog({msg:"请输入手机号"}),!1;var phone=$("#"+_target).val();if(!phone)return dialog({msg:"请输入手机号"}),!1;var vcode=$("#verifycode").val();if(hasError)return!1;var passData={action:"checkSms",type:type,phone:phone,code:vcode,YII_CSRF_TOKEN:zmf.csrfToken},passwd="";if("forget"===type||"authorPass"===type){if(11!==phone.length)return dialog({msg:"请输入有效的11位手机号码"}),!1;if(passwd=$("#password").val(),!passwd||passwd.length<6)return dialog({msg:"请输入长度不小于6位的有效密码"}),!1;passData.password=passwd}$.post(zmf.ajaxUrl,passData,function(result){result=eval("("+result+")"),1===result.status?"exphone"===type?(dialog({msg:"手机号修改成功"}),window.location.href=result.msg):"checkPhone"===type?(dialog({msg:"手机号已验证"}),window.location.href=result.msg):"forget"===type?(dialog({msg:result.msg}),setTimeout(function(){location.href=zmf.loginUrl},1e3)):"authorPass"===type?(dialog({msg:"密码修改成功，正在跳转至登录页面"}),setTimeout(function(){location.href=result.msg},1e3)):($("#hashCode").val(result.msg),$("#send-sms-form").submit()):dialog({msg:result.msg})})}),bindLink()}function bindLink(){$(".ui-grid-full li,.ui-list li,.ui-row li,.ui-avatar,.ui-col,.ui-tiled li").unbind("click").click(function(){$(this).attr("data-href")&&(location.href=$(this).attr("data-href"))})}function cancelBindLink(){$(".ui-grid-full li,.ui-list li,.ui-row li,.ui-avatar,.ui-col").unbind("click")}function showUserSide(){var a=($(this),$("#user-side-holder"));"none"==a.css("display")?(a.show(),$("body").addClass("menu-on")):(a.hide(),$("body").removeClass("menu-on"))}function favorite(a){var b=a.attr("action-data"),c=a.attr("action-type"),d=a.html(),e=parseInt(a.text());if(!b||!c)return!1;if(!checkLogin())return dialog({msg:"请先登录哦~"}),!1;if(!checkAjax())return!1;var f=a.children("i");"tip"===c?f.hasClass("fa-thumbs-up")?a.html('<i class="fa fa-thumbs-o-up"></i> '+--e):a.html('<i class="fa fa-thumbs-up"></i> '+ ++e):"author"===c?a.hasClass("btn-default")?a.removeClass("btn-default").addClass("btn-danger").html('<i class="fa fa-plus"></i> 关注'):a.removeClass("btn-danger").addClass("btn-default").html('<i class="fa fa-check"></i> 已关注'):"book"===c?"已收藏"===a.text()?a.text("加入收藏"):a.text("已收藏"):"post"===c?f.hasClass("fa-thumbs-up")?a.html('<i class="fa fa-thumbs-o-up"></i><sup>'+--e)+"</sup>":a.html('<i class="fa fa-thumbs-up"></i><sup>'+ ++e)+"</sup>":"user"===c?a.hasClass("btn-default")?a.removeClass("btn-default").addClass("btn-danger").html('<i class="fa fa-star-o"></i> 赞'):a.removeClass("btn-danger").addClass("btn-default").html('<i class="fa fa-star"></i> 已赞'):"comment"===c&&(f.hasClass("fa-thumbs-up")?a.html('<i class="fa fa-thumbs-o-up"></i> '+--e):a.html('<i class="fa fa-thumbs-up"></i> '+ ++e)),$.post(zmf.favoriteUrl,{type:c,data:b,YII_CSRF_TOKEN:zmf.csrfToken},function(b){return ajaxReturn=!0,b=$.parseJSON(b),1===b.status||(2===b.status?(a.html(d),dialog({msg:b.msg})):3===b.status||(4===b.status?(a.html(d),dialog({msg:b.msg})):(a.html(d),dialog({msg:b.msg})))),!1})}function getContents(a){var b=a.attr("action-data"),c=a.attr("action-type"),d=a.attr("action-page"),e=a.attr("action-target");if(!checkAjax())return!1;if(!e)return!1;d||(d=1);var f="",g="";"magazine"===zmf.module?f="btn btn-default btn-block":(f="ui-btn-lg",g="ui-btn-wrap");var h='<div class="loading-holder '+g+'"><a class="'+f+' disabled" href="javascript:;">拼命加载中...</a></div>';$("#"+e+"-box").children(".loading-holder").each(function(){$(this).remove()}),$("#"+e+"-box").append(h),$.post(zmf.contentsUrl,{type:c,page:d,data:b,YII_CSRF_TOKEN:zmf.csrfToken},function(h){if(ajaxReturn=!0,a.attr("loaded","1"),h=$.parseJSON(h),1===h.status){var i=h.msg,j="",k="";if(""!==i.html&&(k+=i.html),1===i.loadMore){var l=parseInt(d)+1;j+='<div class="loading-holder '+g+'"><a class="'+f+'"  href="javascript:;" action="get-contents" action-type="'+c+'" action-data="'+b+'" action-page="'+l+'" action-target="'+e+'">加载更多</a></div>'}else j+='<div class="loading-holder '+g+'"><a class="'+f+' disabled" href="javascript:;">已全部加载</a></div>';1===d?($("#"+e+"-box").append(i.formHtml),$("#"+e+"-box .loading-holder").each(function(){$(this).remove()})):$("#"+e+"-box .loading-holder").each(function(){$(this).remove()}),d>1?$("#"+e).append(k):$("#"+e).html(k),$("#"+e+"-box").append(j),rebind()}else dialog({msg:h.msg})})}function dialog(a){if("object"!=typeof a)return!1;closeSimpleDialog();var b=a.msg,c='<div class="simpleDialog" id="simpleDialog">'+b+"</div>";$("body").append(c);var d=$("#simpleDialog"),e=d.width(),f=d.height();d.css({"margin-left":-e/2,"margin-top":-f/2}),d.fadeIn(300),setTimeout("closeSimpleDialog()",2700)}function closeSimpleDialog(){$("#simpleDialog").fadeOut(100).remove()}function scollToComment(){$(".toggle-area").each(function(){$(this).fadeIn(500)});var a=($(window).height(),$(".comment-textarea").offset().top);$("body,html").animate({scrollTop:a},200)}function simpleDialog(a){if("object"!=typeof a)return!1;closeSimpleDialog();var b=a.content,c='<div class="simpleDialog">'+b+"</div>";$("body").append(c);var d=$(".simpleDialog"),e=d.width(),f=d.height();d.css({"margin-left":-e/2,"margin-top":-f/2}),d.fadeIn(300),setTimeout("closeSimpleDialog()",2700)}function getNotice(){doGetNotice(),window.setInterval("doGetNotice()",1e4)}function doGetNotice(){return checkLogin()?void $.post(zmf.ajaxUrl,{action:"getNotice",YII_CSRF_TOKEN:zmf.csrfToken},function(a){if(a=$.parseJSON(a),1===a.status){var b=parseInt(a.msg);b>0?($("#top-nav-count").html(b).css("display","inline-block"),null===flashTitle.timer&&flashTitle.show()):($("#top-nav-count").hide(),flashTitle.clear())}}):!1}function closeSimpleDialog(){$(".simpleDialog").fadeOut(100).remove()}function checkAjax(){return ajaxReturn?(ajaxReturn=!1,!0):(dialog({msg:"请求正在发送中，请稍后"}),!1)}function addComment(dom){var k=dom.attr("action-data"),t=dom.attr("action-type"),to=parseInt($("#replyoneHolder-"+k).attr("tocommentid")),c=$("#content-"+t+"-"+k).val(),username=$("#username-"+t+"-"+k).val(),email=$("#email-"+t+"-"+k).val();if(!k||!t||!c)return dialog({msg:"请填写内容"}),!1;if(username||(username=""),email||(email=""),!checkLogin()){if(!username)return dialog({msg:"请填写称呼"}),!1;if(""!=email){var reg=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!reg.test(email))return dialog({msg:"请填写正确的邮箱地址"}),!1}}return to||(to=0),checkAjax()?void $.post(zmf.addCommentUrl,{k:k,t:t,c:c,to:to,email:email,username:username,YII_CSRF_TOKEN:zmf.csrfToken},function(result){ajaxReturn=!0,result=eval("("+result+")"),"1"==result.status?($("#content-"+t+"-"+k).val(""),$("#comments-"+t+"-"+k).append(result.msg),cancelReplyOne(k)):dialog({msg:result.msg})}):!1}function replyOne(a,b,c){var d="<span class='reply-one'>回复“"+c+"”<a href='javascript:' onclick='cancelReplyOne("+b+")' title='取消设置'> <i class='ui-icon-close-page'></i></a></span>",e=$("#replyoneHolder-"+b).offset().top;$("html,body").animate({scrollTop:e},1e3),$("#replyoneHolder-"+b).attr("tocommentid",a).html(d)}function cancelReplyOne(a){$("#replyoneHolder-"+a).attr("tocommentid","").html("")}function simpleLoading(a){if("object"!=typeof a)return!1;var b=a.title,c='<div class="simple-loading-box"><div class="loading-holder"><i class="fa fa-spinner"></i></div><div class="loading-title"><p>'+b+"</p></div></div>";$("body").append(c);var d=$(".simple-loading-box"),e=d.width(),f=d.height();d.css({"margin-left":-e/2,"margin-top":-f/2}),d.fadeIn(300),setTimeout("closeSimpleLoading()",2700)}function closeSimpleLoading(){$(".simple-loading-box").fadeOut(100).remove()}function checkLogin(){return"undefined"==typeof zmf.hasLogin?!1:"true"===zmf.hasLogin?!0:!1}function zoomThis(a){var b=a.attr("action-type"),c=a.attr("action-data");if(!b||!c)return!1;closeZoom();var d='<div class="zoom-box" id="zoom-box"><div class="zoom-close" onclick="closeZoom()"><i class="fa fa-remove"></i></div><div class="zoom-holder"><div class="zoom-content" id="zoom-holder"></div></div></div>';$("body").append(d);var e="";"img"==b&&(e='<img src="'+c+'"/>');var f=$("#zoom-box"),g=$(window).width(),h=$(window).height();$("#zoom-holder").css({width:g,height:h-20-15}).html(e),f.css({height:h-20}).animate({bottom:0},300)}function closeZoom(){var a=$("#zoom-box");a.animate({bottom:-1e3},150,"linear",function(){a.remove()})}var ajaxReturn=!0,beforeModal;$.support.pjax&&($(document).pjax("a:not([data-remote]):not([data-skip-pjax]):not([data-ajax=false]):not([target=_blank])","#pjax-container",{push:!0,scrollTo:0,fragment:"#pjax-container",timeout:5e3}),$(document).on("pjax:send",function(){simpleLoading({title:"正在加载中..."})}),$(document).on("pjax:complete",function(){closeSimpleLoading(),closeDialog(),rebind()}));var flashTitle={time:0,title:document.title,timer:null,show:function(){var a=flashTitle.title.replace("【　　　】","").replace("【新消息】","");return flashTitle.timer=setTimeout(function(){flashTitle.time++,flashTitle.show(),flashTitle.time%2==0?document.title="【新消息】"+a:document.title="【　　　】"+a},600),[flashTitle.timer,flashTitle.title]},clear:function(){clearTimeout(flashTitle.timer),document.title=flashTitle.title}};!function(a){a.fn.autoResize=function(b){var c=a.extend({onResize:function(){},animate:!0,animateDuration:150,animateCallback:function(){},extraSpace:20,limit:1e3},b);return this.filter("textarea").each(function(){var b=a(this).css({resize:"none","overflow-y":"hidden"}),d=b.height(),e=function(){var c=["height","width","lineHeight","textDecoration","letterSpacing"],d={};return a.each(c,function(a,c){d[c]=b.css(c)}),b.clone().removeAttr("id").removeAttr("name").css({position:"absolute",top:0,left:-9999}).css(d).attr("tabIndex","-1").insertBefore(b)}(),f=null,g=function(){e.height(0).val(a(this).val()).scrollTop(1e4);var g=Math.max(e.scrollTop(),d)+c.extraSpace,h=a(this).add(e);if(f!==g){if(f=g,g>=c.limit)return void a(this).css("overflow-y","");c.onResize.call(this),c.animate&&"block"===b.css("display")?h.stop().animate({height:g},c.animateDuration,c.animateCallback):h.height(g)}};b.unbind(".dynSiz").bind("keyup.dynSiz",g).bind("keydown.dynSiz",g).bind("change.dynSiz",g)}),this}}(jQuery),!function(a,b,c,d){var e=a(b);a.fn.lazyload=function(c){function f(){var b=0;h.each(function(){var c=a(this);if(!i.skip_invisible||"none"!==c.css("display"))if(a.abovethetop(this,i)||a.leftofbegin(this,i));else if(a.belowthefold(this,i)||a.rightoffold(this,i)){if(++b>i.failure_limit)return!1}else c.trigger("appear"),b=0})}var g,h=this,i={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null};return c&&(d!==c.failurelimit&&(c.failure_limit=c.failurelimit,delete c.failurelimit),d!==c.effectspeed&&(c.effect_speed=c.effectspeed,delete c.effectspeed),a.extend(i,c)),g=i.container===d||i.container===b?e:a(i.container),0===i.event.indexOf("scroll")&&g.on(i.event,function(){return f()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,c.one("appear",function(){if(!this.loaded){if(i.appear){var d=h.length;i.appear.call(b,d,i)}a("<img />").on("load",function(){var d,e;c.hide().attr("src",c.data(i.data_attribute))[i.effect](i.effect_speed),b.loaded=!0,d=a.grep(h,function(a){return!a.loaded}),h=a(d),i.load&&(e=h.length,i.load.call(b,e,i))}).attr("src",c.data(i.data_attribute))}}),0!==i.event.indexOf("scroll")&&c.on(i.event,function(){b.loaded||c.trigger("appear")})}),e.on("resize",function(){f()}),/iphone|ipod|ipad.*os 5/gi.test(navigator.appVersion)&&e.on("pageshow",function(b){b=b.originalEvent||b,b.persisted&&h.each(function(){a(this).trigger("appear")})}),a(b).on("load",function(){f()}),this},a.belowthefold=function(c,f){var g;return g=f.container===d||f.container===b?e.height()+e.scrollTop():a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return g=f.container===d||f.container===b?e.width()+e[0].scrollX:a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollTop():a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return g=f.container===d||f.container===b?e[0].scrollX:a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!(a.rightoffold(b,c)||a.leftofbegin(b,c)||a.belowthefold(b,c)||a.abovethetop(b,c))},a.extend(a.fn,{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})}($,window,document),rebind(),getNotice();